# Mnemonic Key
> Mnemonic Phrase generation with Cryptographic Key derivation.

Mnemonic Key is an implementation of 14-word Mnemonic Phrases, with a Cryptographic Key derivation function accepting mnemonics as input. To get started, install install the library:
```bash
npm install mnemonic-key
```
This library consists of two functions: **mnemonic** and **getKey**. The mnemonic function also has two available methods: **toEntropy**, and **validate**. These functions are used in the creation of Mnemonic Phrases, Cryptographic Keys, converting a phrase back to its checksummed entropy, and validating a mnemonic phrase.

## Mnemonic Phrases
Mnemonic Phrases are generated using the `mnemonic` function. This function takes 154 bits of entropy to obtain a mnemonic by mapping 11-bit segments to words from the BIP39 English wordlist, provided by **@scure/bip39**.

```js
mnemonic(entropy);
```
This function expects a single optional `entropy` parameter, expecting at least 154 bits of entropy (suppled in Hexadecimal) when provided. Otherwise, entropy is generated internally with the Node.js **Crypto** module's `crypto.randomBytes();` function. The entropy is truncated to 149 bits, and a checksum is generated by taking the first 5 bits of the SHA-256 hash of the truncated entropy. This checksum is then appended to the end of the truncated entropy to produce a total of 154 bits entropy + checksum.

*Example use with "entropy" provided:*
```js
const { mnemonic } = require('mnemonic-key');

// 200 Bits of entropy in Hex
const entropy = "22496368206D75737320726175732122202D204A616E6E6573";

const mnemonicPhrase = mnemonic(entropy);
console.log("Mnemonic Phrase:", mnemonicPhrase);

// Function Output 
// Mnemonic Phrase: car enrich sure dolphin struggle rifle smart atom gesture process sign dust actress mystery

```
Before the function returns the mnemonic, the Mnemonic Phrase is validated internally via verification of the checksum. If validation is passed, the function returns a 14-word Mnemonic Phrase derived from the generated or provided entropy in its output.

### `toEntropy` Method
This method of the **mnemonic** function allows the checksummed entropy used during the generation of a Mnemonic Phrase to be obtained. This works by reversing the process of mnemonic generation, taking each word of the phrase and mapping it back to an 11-bit segment, assembling all 14 segments back into a string of 154 bits of entropy. This method expects a single `mnemonicPhrase` parameter be provided, which must contain a 14 word Mnemonic Phrase.
```js
mnemonic.toEntropy(mnemonicPhrase);
```

*Example Use:*
```js
const { mnemonic } = require('mnemonic-key');

// Mnemonic Phrase
const mnemonicPhrase = "car enrich sure dolphin struggle rifle smart atom gesture process sign dust actress mystery"

const entropy = mnemonic.toEntropy(mnemonicPhrase);
console.log("Entropy from Mnemonic:", entropy);

// Function Output 
// Entropy from Mnemonic: 0010001001001001011000110110100000100000011011010111010101110011011100110010000001110010011000010111010101110011001000010010001000100000001011010010010011

```
This function returns the checksummed entropy for the provided Mnemonic Phrase in its output.

### `validate` Method
This method of the **mnemonic** function allows for a Mnemonic Phrase to be validated. This works by first obtaining the checksummed entropy of a given Mnemonic Phrase, then verifying the checksum via the same checksum verification function used for internal validation during Mnemonic Phrase generation. This method expects a single `mnemonicPhrase` parameter be provided, which must contain a 14 word Mnemonic Phrase.
```js
mnemonic.validate(mnemonicPhrase);
```

*Example Use:*
```js
const { mnemonic } = require('mnemonic-key');

// Mnemonic Phrase
const mnemonicPhrase = "car enrich sure dolphin struggle rifle smart atom gesture process sign dust actress mystery"

const validation = mnemonic.validate(mnemonicPhrase);
console.log("Valid Mnemonic:", validation);

// Function Output 
// Valid Mnemonic: true

```
This function returns a true or false value in its output, returning true if the Mnemonic Phrase passed validation, and returning false if validation failed.

## Cryptographic Keys
Cryptographic Keys are generated using the **getKey** function. Keys are derived from Mnemonic Phrases using the **PBKDF2** (Password-Based Key Derivation Function 2) synchronous key derivation function.
```js
crypto.pbkdf2Sync(password, salt, iterations, keylen, digest);
```
In this setup, the provided Mnemonic Phrase is converted back to a string of 154 bits (the checksummed entropy), where a SHA-256 hash of the last 77 bits is taken and supplied as the `password`, and a SHA-256 hash of the first 77 bits is taken and encoded in base58 (**@scure/base**) to derive a `salt`. A number of `iterations` is provided, the requested byte length of the key (`keylen`) is set to *32*, and the `digest` is set to *SHA512*.
```js
getKey(mnemonicPhrase, iterations);
```
This function expects a `mnemonicPhrase` parameter, which should be a 14-word Mnemonic Phrase. An optional `iterations` parameter may also be provided, allowing the number of iterations to be specified. If no number is provided, a default of *210,000* will be used, based on the [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pbkdf2) recommendations for **PBKDF2-HMAC-SHA512**.

*Example use without "iterations" provided:*
```js
const { getKey } = require('mnemonic-key');

// Mnemonic Phrase
const mnemonicPhrase = "car enrich sure dolphin struggle rifle smart atom gesture process sign dust actress mystery"

getKey(mnemonicPhrase).then((key) => {
    console.log("Cryptographic Key:", key);
  });

// Function Output 
// Cryptographic Key: bc8266145c9c1c1e056225bab6460bc77789a826e455fa9c7d604b99043991d1

```
This function returns a Cryptographic Key, derived from the provided Mnemonic Phrase, in its output.
